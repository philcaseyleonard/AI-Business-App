<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assignment Tracker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .container {
            max-width: 600px;
            margin: auto;
        }
        .input-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        input, select {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
        }
        button {
            padding: 10px 15px;
            background-color: #007BFF;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        .result {
            margin-top: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 10px;
            text-align: left;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Assignment Tracker</h1>
        <div id="step1">
            <div class="input-group">
                <label for="assignmentName">Assignment Name:</label>
                <input type="text" id="assignmentName">
            </div>
            <div class="input-group">
                <label for="assignmentType">Assignment Type:</label>
                <select id="assignmentType">
                    <option value="">Select Type</option>
                    <option value="Essay">Essay</option>
                    <option value="ResearchPaper">Research Paper</option>
                    <option value="Presentation">Presentation</option>
                    <option value="GroupProject">Group Project</option>
                    <option value="Lab">Lab</option>
                    <option value="Exam">Exam</option>
                    <option value="Quiz">Quiz</option>
                    <option value="Homework">Homework</option>
                    <option value="Other">Other</option>
                </select>
            </div>
            <div class="input-group">
                <label for="assignmentDueDate">Assignment Due Date:</label>
                <input type="date" id="assignmentDueDate">
            </div>
            <button onclick="proceedToStep2()">Next</button>
        </div>

        <div id="step2" style="display:none;">
            <h2>Select Segments</h2>
            <div id="segmentsContainer"></div>
            <button onclick="generateTable()">Generate Table</button>
        </div>

        <div id="step3" style="display:none;">
            <h2>Generated Table</h2>
            <div class="result">
                <table id="assignmentTable">
                    <thead>
                        <tr>
                            <th>Assignment & Segment</th>
                            <th>Due Date</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            <button onclick="downloadAsCSV()">Download as CSV</button>
            <button onclick="downloadAsICS()">Download as ICS</button>
        </div>
    </div>

    <script>
        const segments = {
            Essay: ["Topic Selection", "Research", "Outline", "Drafting", "Revisions", "Final Submission"],
            ResearchPaper: ["Topic Selection", "Literature Review", "Research Design", "Data Analysis", "Drafting", "Revisions", "Final Submission"],
            Presentation: ["Topic Selection", "Research", "Outline", "Slide Creation", "Practice", "Final Presentation"],
            GroupProject: ["Project Planning", "Research and Data Collection", "Drafting", "Revisions", "Final Submission"],
            Lab: ["Pre-Lab Preparation", "Experimentation", "Data Analysis", "Lab Report Drafting", "Revisions", "Final Submission"],
            Exam: ["Study Plan", "Review Materials", "Practice Tests", "Final Review", "Exam Day"],
            Quiz: ["Review Materials", "Practice Questions", "Final Review", "Quiz Day"],
            Homework: [],
            Other: []
        };

        function proceedToStep2() {
            const assignmentType = document.getElementById("assignmentType").value;
            if (!assignmentType) {
                alert("Please select an assignment type.");
                return;
            }

            const segmentsContainer = document.getElementById("segmentsContainer");
            segmentsContainer.innerHTML = ""; // Clear previous segments
            const selectedSegments = segments[assignmentType] || [];

            selectedSegments.forEach(segment => {
                const div = document.createElement("div");
                div.classList.add("input-group");

                const checkbox = document.createElement("input");
                checkbox.type = "checkbox";
                checkbox.value = segment;

                const label = document.createElement("label");
                label.textContent = segment;

                const dateInput = document.createElement("input");
                dateInput.type = "date";
                dateInput.className = "segment-date";

                div.appendChild(checkbox);
                div.appendChild(label);
                div.appendChild(dateInput);

                segmentsContainer.appendChild(div);
            });

            document.getElementById("step1").style.display = "none";
            document.getElementById("step2").style.display = "block";
        }

        function generateTable() {
            const assignmentName = document.getElementById("assignmentName").value;
            const tableBody = document.querySelector("#assignmentTable tbody");
            tableBody.innerHTML = ""; // Clear previous table

            const checkboxes = document.querySelectorAll("#segmentsContainer input[type='checkbox']");
            checkboxes.forEach((checkbox, index) => {
                if (checkbox.checked) {
                    const row = document.createElement("tr");

                    const nameCell = document.createElement("td");
                    nameCell.textContent = `${assignmentName} - ${checkbox.value}`;

                    const dateCell = document.createElement("td");
                    dateCell.textContent = document.querySelectorAll(".segment-date")[index].value;

                    row.appendChild(nameCell);
                    row.appendChild(dateCell);
                    tableBody.appendChild(row);
                }
            });

            document.getElementById("step2").style.display = "none";
            document.getElementById("step3").style.display = "block";
        }

        function downloadAsCSV() {
            const table = document.getElementById("assignmentTable");
            let csvContent = 'data:text/csv;charset=utf-8,';

            const rows = table.querySelectorAll("tr");
            rows.forEach(row => {
                const cells = row.querySelectorAll("th, td");
                const rowContent = Array.from(cells)
                    .map(cell => `"${cell.textContent}"`)
                    .join(",");
                csvContent += rowContent + "\n";
            });

            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "assignments.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function downloadAsICS() {
            let icsContent = "BEGIN:VCALENDAR\nVERSION:2.0\nCALSCALE:GREGORIAN\n";
            const table = document.getElementById("assignmentTable");
            const rows = table.querySelectorAll("tbody tr");

            rows.forEach(row => {
                const cells = row.querySelectorAll("td");
                const assignment = cells[0].textContent;
                const dueDate = cells[1].textContent;

                const icsDate = dueDate.replace(/-/g, "");
                icsContent += `
BEGIN:VEVENT
SUMMARY:${assignment}
DTSTART;VALUE=DATE:${icsDate}
DTEND;VALUE=DATE:${icsDate}
END:VEVENT
`;
            });

            icsContent += "END:VCALENDAR";

            const blob = new Blob([icsContent], { type: "text/calendar" });
            const link = document.createElement("a");
            link.setAttribute("href", URL.createObjectURL(blob));
            link.setAttribute("download", "assignments.ics");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    </script>
</body>
</html>
